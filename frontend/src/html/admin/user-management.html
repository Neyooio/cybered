<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - User Management</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../css/global.css">
  <link rel="stylesheet" href="../../css/modules.css">
  <style>
    .admin-container { padding: 1.25rem; display:flex; flex-direction:column; gap:1rem; }
    .toolbar { display:flex; justify-content:space-between; align-items:center; margin-bottom: 1rem; gap: 1rem; }
    
    /* Search bar */
    .search-wrapper { display: flex; align-items: center; gap: 0.5rem; flex: 1; max-width: 400px; }
    .search-input { 
      flex: 1;
      padding: 0.6rem 1rem; 
      border-radius: 0.5rem; 
      border: 2px solid rgba(249,115,22,.5); 
      background: rgba(15,23,42,.6); 
      color: #fff; 
      font-size: 0.9rem;
      outline: none;
      transition: border-color 0.2s ease;
    }
    .search-input:focus { border-color: rgba(249,115,22,.85); }
    .search-input::placeholder { color: var(--slate-400); }
    
    .refresh-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0.6rem;
      width: 40px;
      height: 40px;
      background: var(--indigo-700);
      border: 2px solid rgba(249,115,22,.5);
      border-radius: 0.5rem;
      color: #fff;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .refresh-btn:hover {
      background: var(--indigo-600);
      border-color: rgba(249,115,22,.85);
    }
    .refresh-btn.spinning {
      animation: spin 0.6s ease-in-out;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .refresh-btn svg {
      flex-shrink: 0;
    }
    
    /* User cards grid */
    .users-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
      gap: 1.25rem; 
      margin-top: 1rem;
    }
    
    /* User card */
    .user-card { 
      position: relative;
      background: linear-gradient(135deg, rgba(15,23,42,.75) 0%, rgba(15,23,42,.65) 100%);
      border: 2px solid rgba(249,115,22,.5);
      border-radius: 0.75rem;
      padding: 1.25rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      min-height: 180px;
    }
    
    .user-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--orange-500), var(--orange-400));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .user-card:hover { 
      border-color: rgba(249,115,22,.85);
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(249,115,22,.3), 0 0 20px rgba(249,115,22,.15);
    }
    
    .user-card:hover::before { opacity: 1; }
    
    .user-card.expanded {
      transform: scale(1);
      z-index: 10;
      border-color: var(--orange-500);
      box-shadow: 0 12px 40px rgba(0,0,0,.5), 0 0 30px rgba(249,115,22,.4);
    }
    
    /* Card content */
    .user-card-header { 
      display: flex; 
      align-items: center; 
      gap: 0.75rem; 
      margin-bottom: 0.75rem;
    }
    
    .user-avatar { 
      width: 48px; 
      height: 48px; 
      border-radius: 50%; 
      border: 2px solid var(--orange-500);
      background: linear-gradient(135deg, var(--indigo-600), var(--indigo-800));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--orange-400);
      text-transform: uppercase;
      flex-shrink: 0;
      object-fit: cover;
    }
    
    .user-info { flex: 1; min-width: 0; }
    
    .user-name { 
      font-size: 1.1rem; 
      font-weight: 700; 
      color: #fff; 
      margin-bottom: 0.25rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .user-email { 
      font-size: 0.8rem; 
      color: var(--slate-300);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .user-meta { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid rgba(255,255,255,.1);
    }
    
    .user-role-badge { 
      padding: 0.25rem 0.65rem; 
      border-radius: 0.5rem; 
      background: var(--indigo-800); 
      border: 1px solid var(--indigo-600); 
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .user-role-badge.admin { 
      background: var(--orange-900); 
      border-color: var(--orange-600);
      color: var(--orange-300);
    }
    
    .user-date { 
      font-size: 0.7rem; 
      color: var(--slate-400);
      text-align: right;
    }
    
    /* Pending Request Badge */
    .user-role-wrapper {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      align-items: flex-start;
    }
    
    .pending-request-badge {
      display: inline-block;
      padding: 0.3rem 0.7rem;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.2) 100%);
      border: 1.5px solid rgba(239, 68, 68, 0.6);
      border-radius: 0.4rem;
      color: #ef4444;
      font-size: 0.7rem;
      font-weight: 700;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      animation: gentlePulse 2s ease-in-out infinite;
      box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
      transition: opacity 0.4s ease;
      opacity: 1;
    }
    
    @keyframes gentlePulse {
      0%, 100% {
        opacity: 1;
        border-color: rgba(239, 68, 68, 0.6);
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
      }
      50% {
        opacity: 0.9;
        border-color: rgba(239, 68, 68, 0.9);
        box-shadow: 0 2px 12px rgba(239, 68, 68, 0.3);
      }
    }
    
    /* Expanded actions */
    .user-actions { 
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(255,255,255,.1);
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .user-card.expanded .user-actions { 
      display: flex;
      animation: slideDown 0.3s ease;
    }
    
    /* Hide action buttons for cards with pending requests */
    .user-card.has-pending .user-actions {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    
    /* Show action buttons on hover for cards with pending requests */
    .user-card.has-pending:hover .user-actions,
    .user-card.has-pending.expanded:hover .user-actions {
      opacity: 1;
      pointer-events: auto;
    }
    
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes zoomHighlight {
      0% {
        transform: scale(1);
        box-shadow: 0 4px 6px -1px rgba(0,0,0,.1);
        border: 2px solid transparent;
      }
      25% {
        transform: scale(1.08);
        box-shadow: 0 0 0 5px rgba(249, 115, 22, 0.6), 0 25px 30px -5px rgba(0,0,0,.4);
        border: 2px solid rgba(249, 115, 22, 0.8);
      }
      75% {
        transform: scale(1.05);
        box-shadow: 0 0 0 5px rgba(249, 115, 22, 0.4), 0 20px 25px -5px rgba(0,0,0,.3);
        border: 2px solid rgba(249, 115, 22, 0.5);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 4px 6px -1px rgba(0,0,0,.1);
        border: 2px solid transparent;
      }
    }
    
    .action-btn { 
      flex: 1;
      min-width: 80px;
      padding: 0.5rem 0.75rem; 
      border-radius: 0.5rem; 
      border: 1px solid rgba(255,255,255,.1);
      background: rgba(15,23,42,.6);
      color: #fff;
      cursor: pointer; 
      font-weight: 600; 
      font-size: 0.8rem;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
    }
    
    .action-btn:hover { 
      background: rgba(15,23,42,.8);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,.3);
    }
    
    .action-btn.visit { 
      background: var(--indigo-700); 
      border-color: var(--indigo-500);
    }
    
    .action-btn.visit:hover { background: var(--indigo-600); }
    
    .action-btn.edit { 
      background: var(--green-700); 
      border-color: var(--green-500);
      color: var(--green-100);
    }
    
    .action-btn.edit:hover { 
      background: var(--green-600); 
    }
    
    .action-btn.approve { 
      background: #059669; 
      border-color: #10b981;
    }
    
    .action-btn.approve:hover { 
      background: #047857;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }
    
    .action-btn.reject { 
      background: #dc2626; 
      border-color: #ef4444;
    }
    
    .action-btn.reject:hover { 
      background: #b91c1c;
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
    }
    
    .action-btn.delete { 
      background: var(--red-700); 
      border-color: var(--red-500);
      color: #fff;
    }
    
    .action-btn.delete:hover { 
      background: var(--red-600);
    }
    
    /* Highlight animation for notification clicks */
    @keyframes highlightPulse {
      0%, 100% {
        box-shadow: 0 12px 40px rgba(0,0,0,.5), 0 0 30px rgba(249,115,22,.4);
      }
      50% {
        box-shadow: 0 12px 40px rgba(0,0,0,.5), 0 0 50px rgba(249,115,22,.8);
      }
    }
    
    .muted { color: var(--slate-400); text-align: center; padding: 2rem; }
    
    /* Mobile responsiveness */
    @media (max-width: 900px) {
      .admin-container { padding: 0.75rem; }
      .toolbar { flex-direction: column; align-items: stretch; }
      .search-wrapper { max-width: 100%; }
      .users-grid { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 1rem; }
      .user-card { padding: 1rem; min-height: 160px; }
      .user-avatar { width: 40px; height: 40px; font-size: 1rem; }
      .user-name { font-size: 1rem; }
      .user-email { font-size: 0.75rem; }
    }
    
    @media (max-width: 600px) {
      .users-grid { grid-template-columns: 1fr; }
      .action-btn { min-width: 70px; font-size: 0.75rem; padding: 0.45rem 0.6rem; }
    }
    
    @media (max-width: 480px) {
      .admin-container { padding: 0.5rem; }
      .user-card { padding: 0.85rem; }
    }
    
    /* Modal Styles */
    .modal-overlay-admin {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.2s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-card-admin {
      background: linear-gradient(135deg, rgba(15,23,42,.98) 0%, rgba(30,41,59,.98) 100%);
      border: 2px solid var(--orange-500);
      border-radius: 1rem;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 20px 60px rgba(0,0,0,.5), 0 0 40px rgba(249,115,22,.3);
      animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .modal-card-wide {
      max-width: 650px;
    }
    
    .modal-card-danger {
      border-color: var(--red-500);
      box-shadow: 0 20px 60px rgba(0,0,0,.5), 0 0 40px rgba(239,68,68,.3);
    }
    
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header-admin {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(249,115,22,.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-header-danger {
      border-bottom-color: rgba(239,68,68,.3);
    }
    
    .modal-header-admin h3 {
      margin: 0;
      font-size: 1.25rem;
      color: var(--orange-400);
      font-weight: 700;
    }
    
    .modal-header-danger h3 {
      color: var(--red-400);
    }
    
    .modal-close-btn {
      background: transparent;
      border: none;
      color: var(--slate-400);
      font-size: 2rem;
      line-height: 1;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
      transition: all 0.2s ease;
    }
    
    .modal-close-btn:hover {
      background: rgba(255,255,255,.1);
      color: #fff;
    }
    
    .modal-body-admin {
      padding: 1.5rem;
    }
    
    .pending-request-alert {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%);
      border: 2px solid rgba(239, 68, 68, 0.5);
      border-radius: 0.75rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      animation: alertPulse 2s ease-in-out infinite;
    }
    
    @keyframes alertPulse {
      0%, 100% {
        border-color: rgba(239, 68, 68, 0.5);
        box-shadow: 0 0 0 rgba(239, 68, 68, 0.2);
      }
      50% {
        border-color: rgba(239, 68, 68, 0.8);
        box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
      }
    }
    
    .pending-request-icon {
      font-size: 1.5rem;
      line-height: 1;
    }
    
    .pending-request-content {
      flex: 1;
      min-width: 0;
      overflow: hidden;
    }
    
    .pending-request-title {
      color: #ef4444;
      font-weight: 700;
      font-size: 0.95rem;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .pending-request-reason {
      color: var(--slate-300);
      font-size: 0.9rem;
      line-height: 1.6;
      font-style: italic;
      word-wrap: break-word;
      word-break: break-word;
      overflow-wrap: break-word;
      white-space: normal;
      max-width: 100%;
    }
    
    .form-section {
      margin-top: 1.5rem;
    }
    
    .user-info-display {
      background: rgba(15,23,42,.4);
      border: 2px solid rgba(249,115,22,.2);
      border-radius: 0.5rem;
      padding: 1.25rem;
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid rgba(249,115,22,.1);
    }
    
    .info-row:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }
    
    .info-row:first-child {
      padding-top: 0;
    }
    
    .info-label {
      color: var(--slate-400);
      font-weight: 600;
      font-size: 0.9rem;
    }
    
    .info-value {
      color: var(--slate-200);
      font-weight: 500;
      font-size: 1rem;
      text-transform: capitalize;
    }
    
    /* Tab Styles */
    .modal-tabs {
      display: flex;
      border-bottom: 2px solid rgba(249,115,22,.2);
      background: rgba(15,23,42,.4);
    }
    
    .modal-tab {
      flex: 1;
      padding: 1rem;
      background: transparent;
      border: none;
      color: var(--slate-400);
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
    }
    
    .modal-tab:hover {
      color: var(--slate-200);
      background: rgba(249,115,22,.1);
    }
    
    .modal-tab.active {
      color: var(--orange-500);
      border-bottom-color: var(--orange-500);
      background: rgba(249,115,22,.15);
    }
    
    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* Role Management Section */
    .role-management-section {
      margin-top: 2rem;
      padding: 1.25rem;
      background: rgba(249,115,22,.05);
      border: 2px solid rgba(249,115,22,.2);
      border-radius: 0.5rem;
    }
    
    .section-title {
      color: var(--orange-500);
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .role-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    
    .role-select {
      flex: 1;
      padding: 0.75rem 1rem;
      background: rgba(15,23,42,.6);
      border: 2px solid rgba(249,115,22,.3);
      border-radius: 0.5rem;
      color: #fff;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      outline: none;
      transition: border-color 0.2s ease;
    }
    
    .role-select:focus {
      border-color: var(--orange-500);
    }
    
    .role-select option {
      background: #1e293b;
      color: #fff;
    }
    
    .no-request-message {
      padding: 3rem 2rem;
      text-align: center;
      color: var(--slate-400);
      font-size: 1rem;
    }
    
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--slate-300);
      font-weight: 600;
      font-size: 0.9rem;
    }
    
    .request-actions-section {
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 2px solid rgba(249,115,22,.3);
    }
    
    .request-actions-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
    }
    
    .request-actions-buttons .modal-btn {
      flex: 1;
      max-width: 220px;
      padding: 0.875rem 1.5rem;
      font-size: 0.95rem;
      font-weight: 600;
    }
    
    .modal-input {
      width: 100%;
      padding: 0.75rem 1rem;
      background: rgba(15,23,42,.6);
      border: 2px solid rgba(249,115,22,.3);
      border-radius: 0.5rem;
      color: #fff;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.2s ease;
    }
    
    .modal-input:focus {
      border-color: var(--orange-500);
    }
    
    .modal-warning-text {
      color: #fff;
      font-size: 1.1rem;
      margin-bottom: 1rem;
      font-weight: 600;
    }
    
    .modal-user-info {
      background: rgba(239,68,68,.15);
      border: 1px solid var(--red-500);
      border-radius: 0.5rem;
      padding: 0.75rem 1rem;
      color: var(--red-300);
      font-weight: 600;
      margin-bottom: 1rem;
    }
    
    .modal-subtext {
      color: var(--slate-400);
      font-size: 0.9rem;
    }
    
    .modal-actions-admin {
      padding: 1rem 1.5rem 1.5rem;
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      flex-wrap: wrap;
    }
    
    #requestActions {
      display: flex;
      gap: 0.75rem;
      margin-right: auto;
    }
    
    .modal-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      border: none;
      transition: all 0.2s ease;
      min-width: 120px;
    }
    
    .modal-btn-cancel {
      background: rgba(148,163,184,.2);
      color: var(--slate-300);
      border: 1px solid rgba(148,163,184,.3);
    }
    
    .modal-btn-cancel:hover {
      background: rgba(148,163,184,.3);
      color: #fff;
    }
    
    .modal-btn-confirm {
      background: var(--orange-500);
      color: var(--black);
    }
    
    .modal-btn-confirm:hover {
      background: var(--orange-400);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(249,115,22,.4);
    }
    
    .modal-btn-success {
      background: #059669;
      color: #fff;
    }
    
    .modal-btn-success:hover {
      background: #047857;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }
    
    .modal-btn-warning {
      background: #f59e0b;
      color: #fff;
    }
    
    .modal-btn-warning:hover {
      background: #d97706;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
    }
    
    .modal-btn-danger {
      background: var(--red-600);
      color: #fff;
    }
    
    .modal-btn-danger:hover {
      background: var(--red-500);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(239,68,68,.4);
    }
    
    /* Toast Notification */
    .toast-notification {
      position: fixed;
      top: 2rem;
      right: 2rem;
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, rgba(15,23,42,.98) 0%, rgba(30,41,59,.98) 100%);
      border: 2px solid var(--orange-500);
      border-radius: 0.75rem;
      color: #fff;
      font-weight: 600;
      box-shadow: 0 8px 24px rgba(0,0,0,.4), 0 0 20px rgba(249,115,22,.3);
      z-index: 3000;
      opacity: 0;
      transform: translateX(400px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
      max-width: 350px;
    }
    
    .toast-notification.show {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }
    
    .toast-notification.success {
      border-color: var(--green-500);
      box-shadow: 0 8px 24px rgba(0,0,0,.4), 0 0 20px rgba(34,197,94,.3);
    }
    
    .toast-notification.error {
      border-color: var(--red-500);
      box-shadow: 0 8px 24px rgba(0,0,0,.4), 0 0 20px rgba(239,68,68,.3);
    }
    
    @media (max-width: 600px) {
      .modal-card-admin {
        width: 95%;
        margin: 1rem;
      }
      
      .modal-actions-admin {
        flex-direction: column-reverse;
      }
      
      .modal-btn {
        width: 100%;
      }
      
      .toast-notification {
        right: 1rem;
        left: 1rem;
        max-width: none;
      }
    }
  </style>
</head>
<body class="site-background">
  <div class="layout-shell">
    <div data-include="../partials/navbar.html"></div>
    <main class="main-wrapper">
      <div data-include="../partials/topbar.html"></div>
      <section class="content-section admin-container">
        <div class="toolbar">
          <h1 class="title-medium">User Management</h1>
          <div class="search-wrapper">
            <input type="text" id="searchInput" class="search-input" placeholder="Search users...">
            <button id="refreshUsersBtn" class="refresh-btn pixel-button" title="Refresh user list">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
          </div>
        </div>
        <div id="usersGrid" class="users-grid"></div>
        <div id="emptyState" class="muted" style="display:none;">No users found.</div>
      </section>
    </main>
  </div>
  
  <!-- Edit User Modal -->
  <div id="editUserModal" class="modal-overlay-admin" style="display:none;">
    <div class="modal-card-admin modal-card-wide">
      <div class="modal-header-admin">
        <h3>User Management</h3>
        <button id="closeEditModal" class="modal-close-btn">×</button>
      </div>
      
      <!-- Tab Navigation -->
      <div class="modal-tabs">
        <button class="modal-tab active" data-tab="details">User Details</button>
        <button class="modal-tab" data-tab="requests">Request Approval</button>
      </div>
      
      <div class="modal-body-admin">
        <!-- User Details Tab -->
        <div id="detailsTab" class="tab-content active">
          <div class="user-info-display">
            <div class="info-row">
              <span class="info-label">Username:</span>
              <span class="info-value" id="displayUsername"></span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value" id="displayEmail"></span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value" id="displayPhone"></span>
            </div>
            <div class="info-row">
              <span class="info-label">Current Role:</span>
              <span class="info-value" id="displayRole"></span>
            </div>
            <div class="info-row">
              <span class="info-label">Avatar:</span>
              <span class="info-value" id="displayAvatar"></span>
            </div>
            <div class="info-row">
              <span class="info-label">Created At:</span>
              <span class="info-value" id="displayCreatedAt"></span>
            </div>
          </div>
          
          <!-- Role Management Section -->
          <div class="role-management-section">
            <h4 class="section-title">Role Management</h4>
            <div class="role-actions">
              <select id="roleSelect" class="role-select" style="display:none;">
                <option value="user">User</option>
                <option value="faculty">Faculty</option>
                <option value="admin">Admin</option>
              </select>
              <button id="updateRoleBtn" class="modal-btn modal-btn-primary" style="display:none;">Update Role</button>
              <button id="revertToUserBtn" class="modal-btn modal-btn-warning" style="display:none;">Revert to User</button>
            </div>
          </div>
        </div>
        
        <!-- Request Approval Tab -->
        <div id="requestsTab" class="tab-content">
          <!-- Pending Request Alert -->
          <div id="pendingRequestAlert" class="pending-request-alert" style="display:none;">
            <div class="pending-request-icon">⚠️</div>
            <div class="pending-request-content">
              <div class="pending-request-title">PENDING FACULTY REQUEST</div>
              <div class="pending-request-reason" id="pendingRequestReason"></div>
            </div>
          </div>
          
          <!-- No Request Message -->
          <div id="noRequestMessage" class="no-request-message">
            <p>This user has no pending role requests.</p>
          </div>
          
          <!-- Request Actions Section -->
          <div id="requestActions" class="request-actions-section" style="display:none;">
            <div class="request-actions-buttons">
              <button id="rejectRequestBtn" class="modal-btn modal-btn-danger">
                Reject Request
              </button>
              <button id="approveRequestBtn" class="modal-btn modal-btn-success">
                Approve & Upgrade to Faculty
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Delete Confirmation Modal -->
  <div id="deleteUserModal" class="modal-overlay-admin" style="display:none;">
    <div class="modal-card-admin modal-card-danger">
      <div class="modal-header-admin modal-header-danger">
        <h3>Confirm Deletion</h3>
        <button id="closeDeleteModal" class="modal-close-btn">×</button>
      </div>
      <div class="modal-body-admin">
        <p class="modal-warning-text">Are you sure you want to delete this user?</p>
        <p class="modal-user-info" id="deleteUserInfo"></p>
        <p class="modal-subtext">This action cannot be undone.</p>
      </div>
      <div class="modal-actions-admin">
        <button id="cancelDeleteBtn" class="modal-btn modal-btn-cancel">Cancel</button>
        <button id="confirmDeleteBtn" class="modal-btn modal-btn-danger">Delete User</button>
      </div>
    </div>
  </div>
  
  <!-- Toast Notification -->
  <div id="toastNotification" class="toast-notification"></div>
  
  <script>
    // Set API_BASE_URL before includes.js loads
    const hostname = window.location.hostname;
    if (hostname.includes('netlify.app') || hostname.includes('github.io') || hostname.includes('onrender.com')) {
      window.API_BASE_URL = 'https://cybered-backend.onrender.com';
    } else if (hostname === 'localhost' || hostname === '127.0.0.1') {
      window.API_BASE_URL = 'http://localhost:4000';
    } else {
      window.API_BASE_URL = `http://${hostname}:4000`;
    }
  </script>
  <script src="../../js/includes.js"></script>

  <script src="../../js/admin-users.js"></script>
</body>
</html>
